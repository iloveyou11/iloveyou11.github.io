<!DOCTYPE html><html><head><meta name="generator" content="Hexo 3.9.0"><meta charset="utf-8"><link rel="stylesheet" href="/js/fancybox/dist/jquery.fancybox.min.css"><title>iframe和定时器的思考 | blog</title><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><meta name="keywords" content="YP's Blog"><meta name="description" content="关于 iframe 的思考好处方便插入第三方内容，但是由于发送了额外的 http 请求，会一定程度上影响整体页面加载，例如各种广告iframe 能够原封不动的把嵌入的网页展现出来，如果有多个网页引用 iframe，那么你只需要修改 iframe 的内容，就可以实现调用的每一个页面内容的更改，方便快捷。网页如果为了统一风格，头部和版本都是一样的，就可以写成一个页面，用 iframe 来嵌套，可以增加"><meta name="keywords" content="web"><meta property="og:type" content="article"><meta property="og:title" content="iframe和定时器的思考"><meta property="og:url" content="http://localhost:4000/2019/07/25/iframe和定时器的思考/index.html"><meta property="og:site_name" content="blog"><meta property="og:description" content="关于 iframe 的思考好处方便插入第三方内容，但是由于发送了额外的 http 请求，会一定程度上影响整体页面加载，例如各种广告iframe 能够原封不动的把嵌入的网页展现出来，如果有多个网页引用 iframe，那么你只需要修改 iframe 的内容，就可以实现调用的每一个页面内容的更改，方便快捷。网页如果为了统一风格，头部和版本都是一样的，就可以写成一个页面，用 iframe 来嵌套，可以增加"><meta property="og:locale" content="default"><meta property="og:updated_time" content="2020-07-06T06:21:54.628Z"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="iframe和定时器的思考"><meta name="twitter:description" content="关于 iframe 的思考好处方便插入第三方内容，但是由于发送了额外的 http 请求，会一定程度上影响整体页面加载，例如各种广告iframe 能够原封不动的把嵌入的网页展现出来，如果有多个网页引用 iframe，那么你只需要修改 iframe 的内容，就可以实现调用的每一个页面内容的更改，方便快捷。网页如果为了统一风格，头部和版本都是一样的，就可以写成一个页面，用 iframe 来嵌套，可以增加"><link rel="icon" href="/favicon.ico"><link href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" type="text/css"><link rel="stylesheet" href="/css/style.css"><script src="/js/pace.min.js"></script></head><script src="https://cdn.bootcdn.net/ajax/libs/jquery/3.5.1/jquery.min.js"></script><script src="/js/fancybox/dist/jquery.fancybox.min.js"></script><script src="/js/wrapimg.js"></script></html><body><div id="container"><header id="header"><div id="banner"></div><div id="header-outer"><div id="header-menu" class="header-menu-pos animated"><div class="header-menu-container"><a href="/" class="left"><span class="site-title">YP&#39;s Blog</span></a><nav id="header-menu-nav" class="right"><a href="/"><i class="fa fa-home"></i> <span>主页</span> </a><a href="/archives"><i class="fa fa-archive"></i> <span>全部</span> </a><a href="/categories/AI/"><i class="fa fa-AI"></i> <span>AI</span> </a><a href="/categories/前端/"><i class="fa fa-前端"></i> <span>前端</span> </a><a href="/categories/计算机/"><i class="fa fa-计算机"></i> <span>计算机</span> </a><a href="/categories/语言/"><i class="fa fa-语言"></i> <span>语言</span> </a><a href="/categories/专题/"><i class="fa fa-专题"></i> <span>专题</span></a></nav><a class="mobile-header-menu-button"><i class="fa fa-bars"></i></a></div></div><div id="header-row"><div id="logo"><a href="/"><img src="/images/logo.png" alt="logo"></a></div><div class="header-info"><div id="header-title"><h2>YP&#39;s Blog</h2></div><div id="header-description"><h3>一个专注前端智能化开发的技术博客</h3></div></div><nav class="header-nav"><div class="social"><a title="Blog" target="_blank" href="https://iloveyou11.github.io/"><i class="fa fa-home fa-2x"></i></a> <a title="Github" target="_blank" href="https://github.com/iloveyou11"><i class="fa fa-github fa-2x"></i></a></div></nav></div></div></header><div class="outer"><section id="main" class="body-wrap"><article id="post-iframe和定时器的思考" class="article article-type-post" itemscope itemprop="blogPost"><div class="article-inner"><header class="article-header"><h1 class="post-title" itemprop="name">iframe和定时器的思考</h1><div class="post-title-bar"><ul><li><i class="fa fa-book"></i> <a href="/categories/前端/">前端</a></li><li><i class="fa fa-calendar"></i> 2019-07-25</li><li><i class="fa fa-eye"></i> <span id="busuanzi_value_page_pv"></span></li></ul></div><div style="margin-top:10px"><span class="post-time"><span class="post-meta-item-icon"><i class="fa fa-keyboard-o"></i> <span class="post-meta-item-text">字数统计: </span><span class="post-count">906字</span> </span></span><span class="post-time">&nbsp; | &nbsp; <span class="post-meta-item-icon"><i class="fa fa-hourglass-half"></i> <span class="post-meta-item-text">阅读时长: </span><span class="post-count">3分</span></span></span></div></header><div class="article-entry post-content" itemprop="articleBody"><div id="toc"><ol class="toc"><li class="toc-item toc-level-4"><a class="toc-link" href="#关于-iframe-的思考"><span class="toc-text">关于 iframe 的思考</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#定时器性能"><span class="toc-text">定时器性能</span></a></li></ol></div><a id="more"></a><h4 id="关于-iframe-的思考"><a href="#关于-iframe-的思考" class="headerlink" title="关于 iframe 的思考"></a>关于 iframe 的思考</h4><p><strong>好处</strong></p><ol><li>方便插入第三方内容，但是由于发送了额外的 http 请求，会一定程度上影响整体页面加载，例如各种广告</li></ol><ul><li>iframe 能够原封不动的把嵌入的网页展现出来，如果有多个网页引用 iframe，那么你只需要修改 iframe 的内容，就可以实现调用的每一个页面内容的更改，方便快捷。</li></ul><!-- more --><ul><li>网页如果为了统一风格，头部和版本都是一样的，就可以写成一个页面，用 iframe 来嵌套，可以增加代码的可重用。但是随着现在前端使用的 MVVM 框架越来越流行，组件化开发方式也成为了大势所趋，越来越多的项目采用组件化编写的方式进行开发和维护，也逐渐抛弃了原有的 iframe。如果遇到加载缓慢的第三方内容如图标和广告，这些问题还是可以由 iframe 来解决。</li></ul><ol start="2"><li>缓存网页，主要是在网络不好的时候</li><li>用于 postMessage 通信</li><li>安全沙箱，避免污染环境</li><li>流量作弊，嵌入一个不展现的 iframe 页面，反作弊很难发现</li></ol><p><strong>缺点</strong></p><ol><li>页面样式调试麻烦，出现多个滚动条；</li><li>浏览器的后退按钮失效；</li><li>过多会增加服务器的 HTTP 请求；</li><li>小型的移动设备无法完全显示框架；</li><li>产生多个页面，不易管理；</li><li>不容易打印；</li><li>代码复杂，无法被一些搜索引擎解读。</li></ol><p><strong>总结</strong><br>1：iframe 会阻塞主页面的 Onload 事件；2：iframe 和主页面共享连接池，而浏览器对相同域的连接有限制，所以会影响页面的并行加载。 iframe，目前是一个过时的技术，不建议在项目中使用。</p><blockquote><p>运维性网站或继承性开发的网站，可以使用 iframe;<br>销售内，官网、展示性网站等建议不使用 iframe;<br>标准的网页设计是不使用 iframe 的。</p></blockquote><p><strong>iframe 与父组件之间的传值</strong></p><ul><li>主页面传值到 iframe：<br>let iFrame = document.getElementById(‘myframe’)<br>iFrame.onload = function(){<br>iFrame.contentWindow.postMessage(‘MessageFromIndex1’,’*‘);<br>}</li><li>iframe 接收传值：<br>function receiveMessageFromIndex ( event ) {<br>console.log( ‘receiveMessageFromIndex’, event )<br>}<br>window.addEventListener(“message”, receiveMessageFromIndex, false);</li><li>iframe 再向主页面传值：<br>parent.postMessage( {msg: ‘MessageFromIframePage’}, ‘*‘);</li><li>主页面接收传值：<br>function receiveMessageFromIframePage (event) {<br>console.log(‘receiveMessageFromIframePage’, event)<br>}<br>window.addEventListener(“message”, receiveMessageFromIframePage, false);</li></ul><h4 id="定时器性能"><a href="#定时器性能" class="headerlink" title="定时器性能"></a>定时器性能</h4><p>探讨 setInterval 和 setTimeout 的解决方案：<br>无论是 setTimeout 还是 setInterval 都逃不过执行延迟，跳帧的问题。为什么呢？原因是事件环中 JS Stack 过于繁忙的原因，当排队轮到定时器的 callback 执行的时候，早已超时。还有一个原因是定时器本身的 callback 操作过于繁重，甚至有 async 的操作，以至于无法预估运行时间，从而设定时间。因此，在设置事件为 500ms 时，不一定是 500ms 时恰好执行。</p><p><strong>需要使用到定时器的场景：</strong><br>1、轮询：当要时刻监视页面内容高度变化时，可以采用轮询方式，实时查询页面高度，可实现动态调整<br>2、轮播：鼠标不在轮播图上时，创建定时器进行轮播，鼠标移开时，销毁定时器<br>3、时钟：制作动态时钟时，需要使用定时器<br>4、函数防抖：延迟函数的执行，减少执行的次数，从而提高性能</p><p><strong>创建和销毁定时器问题：</strong><br>在 vue 或 react 项目开发中，有时会在页面初始化时创建定时器，记得在页面销毁时删除定时器，防止内存泄漏；</p></div><footer class="article-footer"><div class="post-share"><a href="javascript:;" id="share-sub" class="post-share-fab"><i class="fa fa-share-alt"></i></a><div class="post-share-list" id="share-list"><ul class="share-icons"><li><a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=http://localhost:4000/2019/07/25/iframe和定时器的思考/&title=《iframe和定时器的思考》 — blog&pic=/images/banner.jpg" data-title="微博"><i class="fa fa-weibo"></i></a></li><li><a class="weixin share-sns" id="wxFab" href="javascript:;" data-title="微信"><i class="fa fa-weixin"></i></a></li><li><a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=http://localhost:4000/2019/07/25/iframe和定时器的思考/&title=《iframe和定时器的思考》 — blog&source=一个专注前端智能化开发技术的网站" data-title="QQ"><i class="fa fa-qq"></i></a></li><li><a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=http://localhost:4000/2019/07/25/iframe和定时器的思考/" data-title="Facebook"><i class="fa fa-facebook"></i></a></li><li><a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=《iframe和定时器的思考》 — blog&url=http://localhost:4000/2019/07/25/iframe和定时器的思考/&via=http://localhost:4000" data-title="Twitter"><i class="fa fa-twitter"></i></a></li><li><a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=http://localhost:4000/2019/07/25/iframe和定时器的思考/" data-title="Google+"><i class="fa fa-google-plus"></i></a></li></ul></div></div><div class="post-modal wx-share" id="wxShare"><a class="close" href="javascript:;" id="wxShare-close">×</a><p>扫一扫，分享到微信</p><img src="//api.qrserver.com/v1/create-qr-code/?data=http://localhost:4000/2019/07/25/iframe和定时器的思考/" alt="微信分享二维码"></div><div class="mask"></div><ul class="article-footer-menu"></ul></footer></div></article><aside class="post-toc-pos post-toc-top" id="post-toc"><nav class="post-toc-wrap"><ol class="post-toc"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#关于-iframe-的思考"><span class="post-toc-text">关于 iframe 的思考</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#定时器性能"><span class="post-toc-text">定时器性能</span></a></li></ol></nav></aside><nav id="article-nav"><a href="/2019/07/25/LinValidator源码学习/" id="article-nav-newer" class="article-nav-link-wrap"><span class="article-nav-title"><i class="fa fa-hand-o-left" aria-hidden="true"></i> LinValidator源码学习 </span></a><a href="/2019/06/10/koa+nuxt基础/" id="article-nav-older" class="article-nav-link-wrap"><span class="article-nav-title">koa+nuxt基础</span> <i class="fa fa-hand-o-right" aria-hidden="true"></i></a></nav><div id="lv-container" data-id="city" data-uid="MTAyMC81MDE5Mi8yNjY4Mg=="><script type="text/javascript">!function(e,t){var n,c=e.getElementsByTagName(t)[0];"function"!=typeof LivereTower&&((n=e.createElement(t)).src="https://cdn-city.livere.com/js/embed.dist.js",n.async=!0,c.parentNode.insertBefore(n,c))}(document,"script")</script><noscript>为正常使用来必力评论功能请激活JavaScript</noscript></div></section></div><footer id="footer"><div class="outer"><div id="footer-info" class="inner"><p><span id="busuanzi_container_site_uv" style="display:none">总访客数：<span id="busuanzi_value_site_uv"></span> </span><span id="busuanzi_container_site_pv" style="display:none">总访问量：<span id="busuanzi_value_site_pv"></span></span></p><p>Powered by <a href="http://hexo.io/" target="_blank">Hexo</a> Theme <a href="//github.com/wongminho/hexo-theme-miho" target="_blank">MiHo</a> &copy; 2020 Yang Pei<br></p></div></div></footer><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="//cdn.bootcss.com/jquery/3.2.1/jquery.min.js"></script><script>var mihoConfig={root:"http://localhost:4000",animate:"true",isHome:"false",share:"true"}</script><div class="sidebar"><div id="sidebar-top"><span class="sidebar-top-icon"><i class="fa fa-angle-up"></i></span></div></div><div class="sidebar-menu-box" id="sidebar-menu-box"><div class="sidebar-menu-box-container"><div id="sidebar-menu-box-categories"><a class="category-link" href="/categories/AI/">AI</a><a class="category-link" href="/categories/专题/">专题</a><a class="category-link" href="/categories/前端/">前端</a><a class="category-link" href="/categories/计算机/">计算机</a><a class="category-link" href="/categories/语言/">语言</a></div><div id="sidebar-menu-box-tags"></div></div><a href="javascript:;" class="sidebar-menu-box-close">&times;</a></div>ß<div class="mobile-header-menu-nav" id="mobile-header-menu-nav"><div class="mobile-header-menu-container"><span class="title">Menus</span><ul class="mobile-header-menu-navbar"><li><a href="/"><i class="fa fa-home"></i><span>主页</span></a></li><li><a href="/archives"><i class="fa fa-archive"></i><span>全部</span></a></li><li><a href="/categories/AI/"><i class="fa fa-AI"></i><span>AI</span></a></li><li><a href="/categories/前端/"><i class="fa fa-前端"></i><span>前端</span></a></li><li><a href="/categories/计算机/"><i class="fa fa-计算机"></i><span>计算机</span></a></li><li><a href="/categories/语言/"><i class="fa fa-语言"></i><span>语言</span></a></li><li><a href="/categories/专题/"><i class="fa fa-专题"></i><span>专题</span></a></li></ul></div><div class="mobile-header-tag-container"><span class="title">Tags</span><div id="mobile-header-container-tags"></div></div></div><div class="search-wrap"><span class="search-close">&times;</span> <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="back"><i class="icon icon-lg icon-chevron-left"></i> </a><input class="search-field" placeholder="Search..." id="keywords"> <a id="search-submit" href="javascript:;"><i class="fa fa-search"></i></a><div class="search-container" id="search-container"><ul class="search-result" id="search-result"></ul></div></div><div id="search-tpl"><li class="search-result-item"><a href="{url}" class="search-item-li"><span class="search-item-li-title" title="{title}">{title}</span></a></li></div><script src="/js/search.js"></script><script src="/js/main.js"></script><script src="//cdn.bootcss.com/particles.js/2.0.0/particles.min.js"></script><div id="particles"></div><script src="/js/particles.js"></script><link rel="stylesheet" href="//cdn.bootcss.com/animate.css/3.5.0/animate.min.css"><script src="//cdn.bootcss.com/scrollReveal.js/3.0.5/scrollreveal.js"></script><script src="/js/animate.js"></script><script src="/js/pop-img.js"></script><script>$(".article-entry p img").popImg()</script></div><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({model:{jsonPath:"/live2dw/assets/Epsilon2.1.model.json"},display:{position:"right",width:150,height:300},mobile:{show:!1},log:!1,pluginJsPath:"lib/",pluginModelPath:"assets/",pluginRootPath:"live2dw/",tagMode:!1})</script></body>